# F0.11: Setup OpenAPI TypeScript Codegen

**Sprint:** 1 (Infrastructure)
**Type:** Frontend - Setup
**Priority:** High
**Status:** In Progress
**Branch:** feature/sprint1-F0.11-openapi-types
**Created:** 2026-02-09
**Dependencies:** None

---

## Description

Setup `openapi-typescript` to generate TypeScript types from the OpenAPI specification (`api-spec.yaml`). This ensures type safety between frontend and backend, eliminates manual type duplication, and detects breaking API changes at compile time.

**Tool:** [openapi-typescript](https://github.com/drwpow/openapi-typescript) (~1.5M weekly downloads)

**What it does:**
- Reads `api-spec.yaml`
- Generates a single TypeScript file with all API types
- No runtime code, just types

---

## Acceptance Criteria

- [x] `openapi-typescript` installed as dev dependency
- [x] NPM script `generate:api` added to package.json
- [x] Types generated at `frontend/lib/api/types.ts`
- [x] Generated types include all schemas from api-spec.yaml
- [x] CLAUDE.md updated with regeneration instructions
- [x] Manual `frontend/types/auth.ts` removed (replaced by generated types)
- [x] authStore.ts updated to use generated types
- [x] All tests pass
- [x] Build succeeds
- [x] Lint passes

---

## Files to Create/Modify

| File | Action | Purpose |
|------|--------|---------|
| `frontend/lib/api/types.ts` | Create (generated) | All API types |
| `frontend/package.json` | Modify | Add openapi-typescript + script |
| `frontend/stores/authStore.ts` | Modify | Use generated types |
| `frontend/stores/authStore.test.ts` | Modify | Use generated types |
| `frontend/types/auth.ts` | Delete | Replaced by generated types |
| `CLAUDE.md` | Modify | Add regeneration instructions |

---

## Implementation Steps

### Step 1: Install openapi-typescript

```bash
cd frontend && npm install -D openapi-typescript
```

### Step 2: Add NPM Script

Add to `frontend/package.json`:

```json
{
  "scripts": {
    "generate:api": "openapi-typescript ../ai-specs/specs/api-spec.yaml -o lib/api/types.ts"
  }
}
```

### Step 3: Generate Types

```bash
npm run generate:api
```

### Step 4: Update authStore to Use Generated Types

Replace imports from `../types/auth` with generated types:

```typescript
import type { components } from '../lib/api/types';

type User = components['schemas']['User'];
// etc.
```

### Step 5: Delete Manual Types

Remove `frontend/types/auth.ts` (now redundant).

### Step 6: Update CLAUDE.md

Add instruction:
```markdown
## API Types
- Run `npm run generate:api` in frontend/ when api-spec.yaml changes
- Types are generated at `frontend/lib/api/types.ts`
```

### Step 7: Verify

- Run tests: `npm test`
- Run build: `npm run build`
- Run lint: `npm run lint`

---

## Usage After Setup

```typescript
import type { components, paths } from '@/lib/api/types';

// Schema types
type User = components['schemas']['User'];
type LoginRequest = components['schemas']['LoginRequest'];
type AuthResponse = components['schemas']['AuthResponse'];

// Path types (for request/response)
type LoginBody = paths['/auth/login']['post']['requestBody']['content']['application/json'];
```

---

## Definition of Done

- [x] All acceptance criteria met
- [x] Types generate without errors
- [x] Existing tests pass with new types
- [x] No linting errors
- [x] Build succeeds

---

*Ticket created: 2026-02-09*
