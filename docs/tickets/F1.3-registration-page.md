# F1.3: Implement Registration Page

**Sprint:** 1
**Type:** Frontend - Feature
**Priority:** High
**Status:** In Progress
**Branch:** feature/sprint1-F1.3-registration-page
**Created:** 2026-02-09
**Dependencies:** F1.1 (authStore), F1.5 (authService), F0.11 (OpenAPI types)

---

## Description

Create a registration page at `/register` that allows new users to create an account. The page will use the existing `authService.register()` function which calls POST /auth/register. After successful registration, redirect to login page (registration does NOT auto-login).

The form must validate password in real-time against the backend policy and show clear feedback to users.

---

## Acceptance Criteria

- [x] Registration form with email, password, and confirm password fields
- [x] Password policy displayed visibly (12+ chars, uppercase, lowercase, number)
- [x] Real-time validation while user types (debounced)
- [x] Confirm password validation (must match)
- [x] Email format validation
- [x] Loading state during form submission
- [x] Error handling for API errors (duplicate email 409, validation errors 400)
- [x] Success: redirect to `/login` with success message (query param)
- [x] Link "Already have an account? Login" to `/login`
- [x] Accessible form (labels, aria attributes)
- [x] Unit tests for RegisterPage component
- [x] All tests pass (90 tests)
- [x] Build succeeds

---

## Files to Create/Modify

| File | Purpose |
|------|---------|
| `frontend/app/register/page.tsx` | Registration page component |
| `frontend/components/auth/RegisterForm.tsx` | Form component with validation logic |
| `frontend/components/auth/PasswordStrength.tsx` | Password policy indicator component |
| `frontend/lib/validations/auth.ts` | Shared validation functions (password policy, email) |
| `frontend/components/ui/input.tsx` | shadcn/ui Input component (install) |
| `frontend/components/ui/label.tsx` | shadcn/ui Label component (install) |
| `frontend/components/ui/card.tsx` | shadcn/ui Card component (install) |
| `frontend/components/ui/alert.tsx` | shadcn/ui Alert component (install) |
| `frontend/app/register/page.test.tsx` | Unit tests for RegisterPage |
| `frontend/components/auth/RegisterForm.test.tsx` | Unit tests for RegisterForm |

---

## Implementation Steps

### Step 1: Install shadcn/ui Components

1. Run `npx shadcn@latest add input label card alert` in frontend/
2. Verify components are added to `components/ui/`

### Step 2: Create Validation Utilities

1. Create `lib/validations/auth.ts` with:
   - `PASSWORD_POLICY` constant matching backend (minLength: 12, requireUppercase, requireLowercase, requireNumber)
   - `validatePassword(password: string)` → returns `{ isValid: boolean, errors: string[] }`
   - `validateEmail(email: string)` → returns `{ isValid: boolean, error?: string }`
   - `validatePasswordMatch(password: string, confirm: string)` → returns `{ isValid: boolean, error?: string }`

### Step 3: Create PasswordStrength Component

1. Create `components/auth/PasswordStrength.tsx`
2. Display checklist of password requirements with visual indicators:
   - ✓/✗ At least 12 characters
   - ✓/✗ Contains uppercase letter
   - ✓/✗ Contains lowercase letter
   - ✓/✗ Contains number
3. Props: `password: string`
4. Use green/red colors for met/unmet requirements

### Step 4: Create RegisterForm Component

1. Create `components/auth/RegisterForm.tsx`
2. State management:
   - `email`, `password`, `confirmPassword` (controlled inputs)
   - `errors` object for field-level errors
   - `isSubmitting` boolean
   - `apiError` for server errors
3. Real-time validation with `useEffect` + debounce (300ms)
4. Form submission:
   - Validate all fields
   - Call `authService.register({ email, password })`
   - On success: redirect to `/login?registered=true`
   - On 409 error: show "Email already exists"
   - On other errors: show generic message
5. Include PasswordStrength component below password field
6. Include "Already have an account? Login" link

### Step 5: Create Register Page

1. Create `app/register/page.tsx`
2. Centered Card layout with:
   - Title: "Create Account"
   - RegisterForm component
3. Minimal styling with Tailwind

### Step 6: Write Tests

1. Test `lib/validations/auth.ts`:
   - Password validation (all rules)
   - Email validation
   - Password match validation

2. Test `PasswordStrength.tsx`:
   - Renders all requirements
   - Shows correct state for each requirement

3. Test `RegisterForm.tsx`:
   - Renders all fields
   - Shows validation errors
   - Disables submit when invalid
   - Calls authService.register on submit
   - Handles API errors
   - Redirects on success

4. Test `register/page.tsx`:
   - Renders RegisterForm
   - Has correct title

---

## Technical Notes

### Password Policy (must match backend)

```typescript
const PASSWORD_POLICY = {
  minLength: 12,
  requireUppercase: true,
  requireLowercase: true,
  requireNumber: true,
};
```

### API Error Handling

- **409 Conflict**: Email already registered → show "This email is already registered"
- **400 Bad Request**: Validation error → show error message from API
- **Other errors**: Show generic "Registration failed. Please try again."

### Types from OpenAPI

```typescript
import type { components } from '@/lib/api/types';
type RegisterRequest = components['schemas']['RegisterRequest'];
```

### Navigation

Use Next.js `useRouter` for redirect:
```typescript
import { useRouter } from 'next/navigation';
router.push('/login?registered=true');
```

### Testing

- Use `@testing-library/react` for component tests
- Mock `authService` in tests
- Mock `next/navigation` for router tests

---

## Definition of Done

- [x] All acceptance criteria met
- [x] Unit tests written and passing (41 new tests: 17 validations, 8 PasswordStrength, 13 RegisterForm, 3 page)
- [x] Code follows project standards (TypeScript, English, no `any`)
- [x] No linting errors
- [x] Build succeeds
- [ ] Manually tested in browser

---

*Ticket created: 2026-02-09*
